---
title: "Exercise 6: Creating Point Data <br><small>Geographic Information Systems 1 Lab</small></br>"
author: "GEOG 3150"
output:
  html_notebook:
    df_print: paged
    rows.print: 10
    theme: cosmo
    highlight: breezedark
    number_sections: yes
    toc: yes
    toc_float:
      collapsed: no
      smooth_scroll: yes
  pdf_document: default
  html_document:
    toc: yes
    df_print: paged
editor_options:
  chunk_output_type: inline
  mode: gfm
---

```{=html}
<style type="text/css">

h1.title {
  font-size: 40px;
  font-family: "Times New Roman", Times, serif;
  color: DarkBlue;
  text-align: center;
}
h4.author { /* Header 4 - and the author and data headers use this too  */
  font-size: 20px;
  font-family: "Times New Roman", Times, serif;
  color: DarkBlue;
  text-align: center;
}

.zoom {
  transform-origin: 40% 50% 0;
  transition: transform .2s;
  margin: 0 auto;
}
.zoom img{
	width:auto;
	height:auto;	
}
.zoom:hover {
  transform: scale(2);
}

th, td {padding: 5px;}

</style>
```
<hr></hr>

The purpose of this exercise is to teach methods of creating point data for display in various programs. These skills will help you understand the foundation of point data, creation of new point datasets, and editing attribute tables.

# The Introduction

A recent survey was sent to new students at APSU to determine what information they felt was missing in their new student orientation packets. One of the most common responses was that while there is enough dining options on campus, the students were not always aware of where certain options were located. Additionally, students were also interested in dining options were located close to campus. So the [APSU Dining Services](https://www.apsu.edu/dining/index.php) director has asked you to develop a map specific to dining locations in and around campus. On this map the director would like to see the name of each point, a way to determine if it is part of Dining Services or an off-campus location (think about symbology), and some method of listing their hours of operation. They provided a list of campus dining locations and convenience stores [here](https://dineoncampus.com/apsu/hours-of-operation). Off campus dining should be within walking distance (~1mi). A dataset for this has been developed by obtaining location information from [other sources](https://www.google.com/search?rlz=1C1GCEU_enUS880US880&tbs=lf:1,lf_ui:9&tbm=lcl&sxsrf=AOaemvIjLEw11Ti6yVkpO2bynAOhhlsQMA:1631811609395&q=dining+near+me&rflfq=1&num=10&ved=2ahUKEwjOs8X6-4PzAhWmSPEDHU7vCjUQtgN6BAgMEAc#rlfi=hd:;si:;mv:[[36.54333655278211,-87.33321681176771],[36.517956229819426,-87.37012400781263],null,[36.530647432362045,-87.35167040979017],15]). However, if there is missing information from this list you should feel free to append the data.

In this exercise you will:

-   Learn to create point data
-   Work with external datasets that contain x,y data
-   Edit and add information to the attribute table
-   Optionally work to:
    -   Develop multi-part symbology
    -   Add tables to a map

Software specific directions can be found for each step below. Please submit the answer to the questions and your final map by the due date.

## Step One: The Data

You will need to use aerial imagery for this exercise in order to identify the dining locations on and off campus. The information contained in the link in the introduction should provide you all of the basic information. Adding Montgomery County or the county/state datasets for Tennessee from previous exercises might help to provide location information but is not necessarily required. 

<details>
<summary><big>View Directions in <b> [ArcGIS Pro]{style="color:#ff4500"} </b></big></summary>

Blah...blah...blah...

<big><b>Question No. 1</b></big>
<blockquote>
_Insert Text Here_
</blockquote>

</details>
<hr></hr>

<details>
<summary><big>View directions in <b> [QGIS]{style="color: #006400"} </b></big></summary>

In [Exercise 4, Step 2](https://chrismgentry.github.io/GIS1-Exercise-4/#12_Step_Two:_The_Analyses) you added a remote connection to satellite imagery using the **XYZ Tiles** of the _Browser Pane_. Because this exercise will rely heavily on having accessible imagery you will begin by adding several other remote connections. This way you have options as to which imagery works best for this exercise. Remember in [Exercise 4](https://chrismgentry.github.io/GIS1-Exercise-4/#12_Step_Two:_The_Analyses) you needed to right/CRTL-click on **XYZ Tiles** and add a "New Connection". Below is the URLs you need to use for each connection:

| **Service** | **Provider** | **URL** | **Appx. Max Scale** |
| ----------- | ------------ | ------- | ------------------- |  
| Satellite Imagery | Bing | http://ecn.t3.tiles.virtualearth.net/tiles/a{q}.jpeg?g=1 | 1:1 |
| Satellite Imagery | ESRI | https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x} | 1:1 |
| Street Map | [OpenStreetMap](https://www.openstreetmap.org/) | https://tile.openstreetmap.org/{z}/{x}/{y}.png | 1:1 |
| Topographic Map | [OpenStreetMap](https://www.openstreetmap.org/) | https://tile.opentopomap.org/{z}/{x}/{y}.png | 1:3400 |

You will be using one of the services above to locate the on and off-campus dining locations so take some time to <u>add each one to your layers and examine the area surrounding campus</u>. It is up to you to choose which type of imagery is best used for the data creation as well as the final map for this assignment.

Once you have selected the imagery you plan to use, click _Layer > Create Layer > New Shapefile Layer_ to create a new shapefile dataset. In the resulting window, click on the browse button <img src= "Images/qgis-file-location-button.jpg" alt="Browse for file location" width="20" height="20"> to give your shapefile a new name and save it in your project folder. 

<p align="center"><div class="zoom"><img src= "Images/qgis-new-shapefile-layer.png" alt="New Shapefile Layer" style="width:100%"></div></p>

For the rest of the options use the following settings:

- File encoding = UTF-8
- Geometry type = Point
- Additional dimensions = None, EPSG:4326 - WGS 84
- New Field
  - Name = Name
  - Type = TextData
  - Length = 80

<p align="center"><div class="zoom"><img src= "Images/qgis-new-shapefile-layer-dialog.png" alt="New Shapefile Layer Box" style="width:100%"></div></p>

Because you will be creating a series of points the geometry should be set to point. However, you would take these same steps to create a multipoint, line, or polygon shapefile as well. The UTF-8 encoding allows for the dataset to be used on Windows of Mac OS systems which enables the possibility of sharing the data. After adding the information for the New Field click the button to **Add to Fields List** to add a field called "Name" to your dataset and click OK.

This will create a new dataset in your layers that allows you to add additional point information. With the new dataset selected, begin by either right/CRTL clicking on the new data layer or clicking the pencil icon <img src= "Images/qgis-toggle-editing-button.jpg" alt="Toggle Editing" width="20" height="20"> to _Toggle Editing_. This will make the new layer editable. Next, click on the **Add Point Feature** button <img src= "Images/qgis-add-point-feature-button.jpg" alt="Add Point Feature" width="20" height="20"> and notice as your cursor becomes a target.

<p align="center"><div class="zoom"><img src= "Images/qgis-edit-new-shapefile.png" alt="Adding Point Data" style="width:100%"></div></p>

Place the target over the Woodward Library building _roughly_ where the [Starbucks](https://www.starbucks.com/store-locator/store/87005/austin-peay-state-university-601-college-st-clarksville-tn-370440001-us) is located and click. In the resulting window give this location attributes where the **id = 1** and the **Name = Starbucks** and click OK. You will notice a new point that appears on the map and your cursor will return to a target like appearance. This created point data representing Starbucks and is uniquely identified by the ID and Name variables. Repeat this process and create points for all of the on-campus dining locations and convenience stores (~12). For the ID field continue to increase the number by one each time and for the Name field type in the name of the location you are depicting. When you have finished the last data point, click the _Save Layer Edits_ button <img src= "Images/qgis-save-layer-edits-button.jpg" alt="Save Layer Edits" width="20" height="20"> and toggle editing for that layer off by clicking the toggle button <img src= "Images/qgis-toggle-editing-button.jpg" alt="Toggle Editing" width="20" height="20">.

With the on-campus locations created you could also use the same steps to create the off-campus location. However, sometimes you will find that collaborators send you information in the form of a spreadsheet or some other format such as **keyhole markup langauge** (KML) from Google Earth or a KMZ which is a compressed version of a KML. In [Exercise 5, Step 2](https://chrismgentry.github.io/GIS1-Exercise-5/#12_Step_Two:_The_Analyses) you learned how to import a \*.csv file without geometry (meaning there were no X and Y values for locations). If the \*.csv file has variables for a location, such as longitude and latitude or UTM, you can simply choose "Point Coordinate" and provide the fields where the XY data is located. However, with a useful QGIS plug-in you have the ability to import some data directly from a URL depending on the format. Similar to [Exercise 5, Step 4](https://chrismgentry.github.io/GIS1-Exercise-5/#14_Step_Four:_The_County_Commisson_Report), go to **Plugins > Manage and Install Plugins** on the menu bar and search for **MMQGIS** and install the plug-in.

<p align="center"><img src= "Images/mmqgis-plugin-page.png" alt="MMQGIS" style="width:85%"></p>

On the menu bar you will see a new option for MMQGIS available. Click _MMQGIS > Import/Export > Geometry Import from CSV File_ and in the resulting window use the following options and click apply:

- Input CSV Nodes File = https://raw.githubusercontent.com/chrismgentry/GIS1-Exercise-6/main/Data/off-campus-dining.csv
- Geometry type = Point
- Shape ID Field = name
- Part ID Field = (this should be grayed out and not accessible)
- Latitude Field = y
- Longitude Field = x
- Output File Name = In this field click on the browse button to give the new file a name and save it to your project folder

<p align="center"><div class="zoom"><img src= "Images/mmqgis-import-dialog.png" alt="Importing CSV File with MMQGIS" style="width:100%"></div></p>

The resulting import should have placed another 24 data points on your map. You can use right/CRTL click and "Zoom to Layer" on the new layer to see all of the new points (colors my vary).

<p align="center"><div class="zoom"><img src= "Images/qgis-off-campus-import.png" alt="Imported CSV Points" style="width:100%"></div></p>

<big><b>Question No. 1</b></big>
<blockquote>
_Which on-campus location is the last to close on a Saturday night? What other variables were included in the off-campus points that weren't included in the on-campus data you created?_
</blockquote>

</details>
<hr></hr>

<details><summary><big>View directions in <b> [R]{style="color: #6495ED"} </b></span></big></summary>
Before you begin, you will need to open the [Ex2 Colab Notebook](https://github.com/chrismgentry/GIS1-Exercise-6/blob/main/GIS1_EX6.ipynb) and insert **tocolab** after _github_ in the URL to open in the _Colab Environment_. As you have seen before, R requires various packages to complete certain analyses. In this exercise you will be using **tidyverse, OpenStreetMaps, ggfortify, maptools, and rgeos**. To install and load the packages we will use the following script:

Blah...blah...blah...

<big><b>Question No. 1</b></big>
<blockquote>
_Insert Text Here_
</blockquote>

</details>

## Step Two: The Analyses

With datasets for both on-campus and off-campus created, in this step you will edit the attribute table to provide options for categorizations when making the final map.

<details>
<summary><big>View Directions in <b> [ArcGIS Pro]{style="color:#ff4500"} </b></big></summary>

Blah...blah...blah...

<big><b>Question No. 2</b></big>
<blockquote>
_Insert Text Here_
</blockquote>

</details>
<hr></hr>

<details>
<summary><big>View Directions in <b> [QGIS]{style="color:#006400"} </b></big></summary>

Now that you have your two datasets it makes sense to merge them into one combined file. In the _Processing Toolbox_ or in _Vector > Data Management Tools > Merge Vecor Layers_ on the menu bar, open the processing tool to create a merged dataset.

<p align="center"><div class="zoom"><img src= "Images/qgis-merge.png" alt="Merge Vector Layers" style="width:100%"></div></p>

In the **Merge Vector Layers** dialog box click browse button <img src= "Images/qgis-file-location-button.jpg" alt="Browse for file location" width="20" height="20"> to select the input layers. Using the select all button or by checking the boxes next to each layer, select the on and off campus datasets and click the _Go Back_ button <img src= "Images/qgis-go-back-button.jpg" alt="Go Back Button" width="20" height="20"> to return to the main merge menu. To save the dataset as a permanent file click the browse button <img src= "Images/qgis-file-location-button.jpg" alt="Browse for file location" width="20" height="20"> in the _Merged_ option and select "Save to File..." Remember to save it in your project folder.

With the newly merged dataset added to your layers, open the attribute table to examine the output.

<p align="center"><div class="zoom"><img src= "Images/qgis-merged-attribute-tables.png" alt="Merge Vector Layer Attribute Table" style="width:100%"></div></p>

Notice that the variables from each dataset are now included in the full table. However, because each attribute table had varying data some of the cells are filled will _NULL_ values. To edit these values click on the toggle editing button <img src= "Images/qgis-toggle-editing-button.jpg" alt="Toggle Editing" width="20" height="20"> <u>on the attribute table</u> and you will be able to click within each _NULL_ value cell and edit the information. For this exercise focus on completing the ID (simply number them 1-36), location (off-campus or on-campus), hours, and hours_cate (short for category) columns. The X and Y columns are completed for the off-campus locations because the information was included in the initial \*.csv file. When you created the on-campus locations that data is not specifically recorded in the attribute table. So don't worry about adding that information into the table as it is very unlikely it will be useful for the visualization.

If you are interested in creating an additional field to provide further data about the locations (type of food, dining atmosphere, etc.) you can click the **New Field** button while editing is toggled on in the attribute table to make a new field. In the window give the field a _name_, _type_ such as integer, decimal, text, date, etc., _length_ which is the number of "characters" for any non text or integer value, and/or _precision_ which is the number of places to the right of the decimal. Think about categories you can create that might be useful in your visualization.

<big><b>Question No. 2</b></big>
<blockquote>
_Based on  date in the attribute table, how many locations would not be an option at 3pm this afternoon?_
</blockquote>

</details>
<hr></hr>

<details>
<summary><big>View Directions in <b> [R]{style="color:#6495ED"} </b></big></summary>

Blah...blah...blah...

<big><b>Question No. 2</b></big>
<blockquote>
_Insert Text Here_
</blockquote>

</details>

## Step Three: The Visualization

In this step you will use previous examples and your own design concepts to create a visualization that can be distributed by APSU Dining Services to students as part of their "Welcome to Campus" packet when they arrive in the fall. You may need to use various inset maps or other methods to ensure all locations can be viewed.

<details><summary><big>View directions in <b> [ArcGIS Pro]{style="color:#ff4500"} </b></span></big></summary>

Blah...blah...blah...

<big><b>Question No. 3</b></big>
<blockquote>
_Insert Text Here_
</blockquote>

</details>
<hr></hr>

<details><summary><big>View directions in <b> [QGIS]{style="color:#006400"} </b></span></big></summary>

Unlike previous exercises, there will not be an example provided of how this map could be made. Because there is a large number and variety of data points you will need to think about how to create the most useful visualization possible for dining services. However, in [Exercise 4, Step 4](https://chrismgentry.github.io/GIS1-Exercise-4/#14_Step_Four:_Your_Turn) you used a more advanced labeling feature to filter out and add labels to specific locations to the map. This process skipped over the basic steps for labeling data. While you could use the more advance rule-based labeling for this, here is how you produce basic labels for a given dataset. 

Right/CRTL click on the dataset you wish to label can select the properties menu. Navigate to the Labels tab on the left and select **Single Labels** from the drop-down menu at the top of the window. 

<p align="center"><div class="zoom"><img src= "Images/qgis-labeling-options.png" alt="Single Labels" style="width:100%"></div></p>

This will provide a number of options for label customizations once you select the **Value** or the field you want to be used for the labels. In this case you want to select _name_. Now you can move through the various options on the left such as _text_, _formatting_, _buffer_, _mask_, _background_, _shadow_, etc. to design a style of labeling that is appropriate for display on your map.

One last option for this visualization is to change the opacity of the background imagery. Depending on the background that was selected, the intensity or variation in the color or texture can make it difficult to visualize some overlays. By right/CRTL clicking on the background imagery layer and selecting **Transparency** you can change the _Global Opacity_ value to adjust how the layer is displayed. This might help with the legibility of the labels.

Because of the difficulties with label organization on various maps, some cartographers prefer to manually label items so their precise positioning can be controlled better than if placed by the software.

<big><b>Question No. 3</b></big>
<blockquote>
_By changing the labeling options, describe the difference between what **mask** and **buffer** do._
</blockquote>

</details>
<hr></hr>

<details><summary><big>View directions in <b> [R]{style="color:#6495ED"} </b></span></big></summary>

Blah...blah...blah...

<big><b>Question No. 3</b></big>
<blockquote>
_Insert Text Here_
</blockquote>

</details>

## Step Four: Culinary Cartography

After reviewing the information you have collected with the APSU Dining Services Director, they have given you full control of the final design of the map but asked that you include and APSU logo on the map. To download official logos for the university you must go do [http://aspire.apsu.edu](http://aspire.apsu.edu) and click the login link in the upper right corner. Using the APSU Login link, enter your OneStop username/password and click login. On the ASPIRE Homepage click the link for Public Relations and Marketing under the Communities heading in the center of the page. Under "Recent Submissions" you will find a number of different logos to choose from. Select the one you would like to use and click on the link. Finally select either the JPEG or PNG version of the logo and right/CRTL click on the corresponding view/open link to download to your project folder. Once you have the logo you can log out.

<details><summary><big>View directions in <b> [ArcGIS Pro]{style="color:#ff4500"} </b></span></big></summary>

Blah...blah...blah...

<big><b>Question No. 4</b></big>
<blockquote>
_Insert Text Here_
</blockquote>

</details>
<hr></hr>

<details><summary><big>View directions in <b> [QGIS]{style="color:#006400"} </b></span></big></summary>

Although the final design of the dining map will be up to you, there are a couple techniques which might be helpful in trying to visually organize the data on the layout screen. In [Exercise 4, Step 3](https://chrismgentry.github.io/GIS1-Exercise-4/#13_Step_Three:_The_Visualization) you learned how to create an inset map that provided a small scale view of the dataset. Insets can also be used to view clustered data in a large scale view. For example, in the sample images above you can see a few distinct dining clusters that could be placed in a larger scale inset to provide additional legibility. Following similar steps to [Exercise 4, Step 3](https://chrismgentry.github.io/GIS1-Exercise-4/#13_Step_Three:_The_Visualization) you can create an inset for the locations along University Ave. In this case, because the inset is at a larger scale than the primary map, you can have [QGIS]{style="color:#006400"} create an **overview** to highlight the inset location.

After creating the large scale inset on your layout, right/CRTL click on the primary map and select _Item Properties_. Scroll down to **Overviews** and click the drop-down arrow.

<p align="center"><div class="zoom"><img src= "Images/qgis-overviews.png" alt="Creating Overviews" style="width:100%"></div></p>

With _Overview_ open, click the green plus button and select your map inset map. With the draw overview box checked you should see a highlighted area on the primary map of where the inset is located. 

<p align="center"><div class="zoom"><img src= "Images/qgis-overview-map.png" alt="Overview Map Styling" style="width:100%"></div></p>

If you were to create multiple overviews you could simply add some identifying text like a capital letter A in matching boxes and B in the second boxes or create some other way to identify which inset connects to which area. 

Additionally, there are times you may want to add a table to your map. Suppose you would want to add the attribute table information to the inset you just created to use the IDs as the location indicators and allow the users to scan the table for specific information. This can be accomplished by clicking the **Add attribute table** button <img src= "Images/qgis-add-attribute-table-button.jpg" alt="Add attribute table" width="20" height="20"> in the layout and drawing a square on the map. Once loaded the entire attribute table will overwhelm the map. However, this can be adjusted by selecting the attribute table and opening the item properties.

With the Source set as "Layer Features" and the Layer set as the merged dataset you created above you should be able to click the **Attributes...** to open a _Select Attributes_ window. Using the up, down, add, and remove boxes you can select the data you would like to remove from the map table or add additional rows. Next you need to click the box for "Show only features visible within a map" and select your inset in the linked map options.

<p align="center"><div class="zoom"><img src= "Images/qgis-add-table-options.png" alt="Add Table" style="width:100%"></div></p>

Once you have the data linked, you can scroll down and adjust all of the options to format the table to fit your design before closing the item properties.

<p align="center"><div class="zoom"><img src= "Images/qgis-table-added.png" alt="Table Styling" style="width:100%"></div></p>

While tables are not required and should be used sparingly, they can be used to help provide additional information regarding the data that cannot be displayed through labels. However, there are always ways to create symbology that can hold multiple attributes simultaneously as discussed in lecture.

Finally, to add the APSU logo to your layout, click the **Add Picture** button <img src= "Images/qgis-add-image-button.png" alt="Add picture" width="20" height="20"> and draw a square on the map to place the object. Open the item properties to make any necessary adjustments.

<big><b>Question No. 4</b></big>
<blockquote>
_On a map with the primary as large scale and the inset as small scale which map would you select to set the overview?_
</blockquote>

</details>
<hr></hr>

<details><summary><big>View directions in <b> [R]{style="color:#6495ED"} </b></span></big></summary>

Blah...blah...blah...

<big><b>Question No. 4</b></big>
<blockquote>
_Insert Text Here_
</blockquote>

</details>

# The Write-Up

In the presentation of the map you provide to the APSU Dining Services Director please provide the following information:

- Discuss the challenges you encountered mapping the data.
- Describe what information that was not immediately available (if any) that could have helped you create a better product.

When complete, send a link to your _Colab Notebook_ or word document with answers to Questions 1-4, the write-up, and your completed map via email.